version: '3'

tasks:
  flux:
    desc: Installing flux cli using the official script
    cmds:
      - curl -s https://fluxcd.io/install.sh | sudo bash

  helm:
    desc: Installing helm3
    cmds:
      - curl -fsSL https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | sudo bash

  kubectl:
    desc: Installing kubectl
    cmds:
      - sudo curl --output /usr/local/bin/kubectl -L "https://storage.googleapis.com/kubernetes-release/release/{{.VERSION}}/bin/linux/amd64/kubectl"
    vars:
      VERSION:
         sh: curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt

  sops:
    desc: Installing sops
    cmds:
      -  sudo curl -sSLf --output /usr/local/bin/sops https://github.com/mozilla/sops/releases/download/{{.LATEST_VERSION}}/sops-{{.LATEST_VERSION}}.linux
    vars:
      LATEST_VERSION:
        sh: curl --silent "https://api.github.com/repos/mozilla/sops/releases/latest" | jq -r .tag_name

  direnv:
    desc: Installing direnv
    cmds:
      - sudo curl -sSLf --output /usr/local/bin/direnv https://github.com/direnv/direnv/releases/download/{{.LATEST_VERSION}}/direnv.linux-amd64
    vars:
      LATEST_VERSION:
        sh: curl --silent "https://api.github.com/repos/direnv/direnv/releases/latest" | jq -r .tag_name
